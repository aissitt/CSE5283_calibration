# CSE5283_calibration
# Assignment 1
Camera calibration core. OpenCV pipeline with small utilities and demo scripts. The Gradio UI (`camera_ui.ipynb`) and simple 3D pose visualization are included for quick inspection.

## Setup (Conda)
```bash
conda env create -f environment.yml
conda activate calibration
```

## Full calibration (with undistort preview)
Place your chessboard photos in `data/images/` then run:

```bash
# Run full calibration and create a wide undistort preview
python scripts/run_calibration.py \
	--images_dir data/images \
	--cols 9 --rows 6 \
	--square_size 22.0 \
	--visualize_corners_to data/results/corners \
	--out_json data/results/calibration.json \
	--preview_image data/images/1.jpg \
	--preview_out data/results/undistort_preview.jpg \
	--undistort_alpha 0.85 \
	--undistort_center_pp
```

Notes:
- `--undistort_alpha 0.85` gives a wide but not over-cropped undistortion preview.
- `--undistort_center_pp` recenters the principal point when creating the preview camera matrix.

## Other utilities & demos
Use these small scripts to create overlays and pose visualizations from the saved calibration JSON.

- Axes overlays (draws camera axes on calibration images):

```bash
python scripts/test_axes_overlay.py \
	--output_dir data/results/axes \
	--max_images 20
```

- Simple pose visualization (2D + 3D views):

```bash
python scripts/test_pose_viz.py \
	--output_dir data/results/pose_viz
```

- If you only want an undistort preview for a particular image (without re-running full calibration):

```bash
python scripts/run_calibration.py --preview_image data/images/13.jpg --undistort_alpha 0.85 --preview_out data/results/undistort_preview.jpg --undistort_center_pp
```

## Gradio UI
You can interact with the pipeline via the notebook `camera_ui.ipynb`.

- Run locally (recommended when working on a machine with the Conda env):

```bash
conda activate calibration
jupyter lab    # or `jupyter notebook`
# open camera_ui.ipynb and run the cells; the Gradio app will launch in a browser tab
```

- Or open the provided Colab copy to run the UI in the cloud:

https://colab.research.google.com/drive/13ZnJN2zm5rFGu9IKx2yDr40TE56FrnhB

Notes for Colab:
- Copy the notebook to your Drive (File -> Save a copy in Drive) and edit the file to clone this repo or upload your calibration files.
- Colab may require `pip install` of a few packages (see top of the notebook).

## Outputs (where to look)
- `data/results/calibration.json` — calibrated intrinsics `K`, distortion coefficients, `rvecs`/`tvecs`, RMS and per-image RMSE.
- `data/results/corners/` — images with detected chessboard corners drawn (sanity check).
- `data/results/undistort_preview.jpg` — side-by-side before/after undistortion preview.
- `data/results/axes/` — axes overlay images generated by `test_axes_overlay.py`.
- `data/results/pose_viz/` — saved pose visualization PNGs from `test_pose_viz.py`.

## Quick sanity check
```bash
conda activate calibration
python scripts/run_calibration.py --images_dir data/images --cols 9 --rows 6 --square_size 22.0 --visualize_corners_to data/results/corners --out_json data/results/calibration.json
```

Open `data/results/corners/` to verify corner detection, then run the axes/pose scripts above or use the Gradio UI notebook.

## Notes
- Pattern size uses inner corners (OpenCV).
- Square size is in millimeters.
- The repo's helpers (in `calibration/`) follow a compact API so the code can be extended or embedded in other tools.

# Assignment 2
## Assignment 2: Gradio UI Workflow

The notebook `notebooks/assignment2_ui.ipynb` provides a multi-tab Gradio interface for planar pose estimation. Follow these steps:

1. **Calibration Tab**: Run calibration on chessboard images and save the intrinsics (`K`, `distCoeffs`) as a JSON file.
2. **Model Plane Tab**: Generate or load model points (checkerboard or custom), then save them as a CSV or JSON file.
3. **Pose on Image Tab**: Load a sample image, the saved intrinsics JSON, and the saved model points file. Click points in the image in the same order as the model. Run pose estimation to see overlays and pose results.
4. **Compare & 3D Viz Tab**: View numeric comparison and 3D visualization of the computed poses.

This workflow ensures you use the correct calibration and model data for pose estimation and visualization. Each tab guides you through the required steps interactively.